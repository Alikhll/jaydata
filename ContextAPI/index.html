<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
<title>Context Manager</title>
<script src="inflection.js" type="text/javascript"></script>
<script src="knockout-2.1.0.js" type="text/javascript"></script>
<script src="jaydata.js" type="text/javascript"></script>
<script src="contextapi-context.js" type="text/javascript"></script>
<script src="context.js" type="text/javascript"></script>
<link rel="stylesheet" href="app.css" type="text/css"/>
<script src="app.js" type="text/javascript"></script>
</head>
<body>
    <div class="column">
        <div id="entity-container" class="container" data-bind="foreach: entityCollection">
            <div class="entity" data-bind="click: $root.selectEntity, css: { selected: $root.selectedEntity() == $data }">
                <span class="fullname" data-bind="text: $data.fullName"></span>
                <div data-bind="foreach: $data.memberDefinitions.getPublicMappedProperties()">
                    <div>
                        <div class="icon" data-bind="css: { key: $data.key }"></div>
                        <span data-bind="text: $root.entityField($data)"></span>
                    </div>
                </div>
                <div class="controls">
                    <button class="btn edit" data-bind="click: $root.editEntity">Edit</button>
                    <button class="btn insert" data-bind="click: $root.insertAsEntitySet">Insert</button>
                    <button class="btn remove" data-bind="click: $root.removeEntity">Remove</button>
                </div>
            </div>
        </div>
        <div class="entity-controls">
            Entity type name:
            <input type="text" data-bind="value: addEntityTypeName, event: { keyup: addEntityValidator }"/>
            <button class="btn add" data-bind="click: $root.addEntity, enable: addEntityEnabled">Add</button>
        </div>
    </div>
    <div class="column">
        <div id="entityset-container" class="container">
            <span class="fullname" data-bind="text: context().fullName"></span>
            <div data-bind="foreach: entitySetCollection">
                <div class="entityset" data-bind="click: $root.selectEntitySet, css: { selected: $root.selectedEntitySet() == $data }">
                    <div class="icon"></div>
                    <span data-bind="text: $data.name"></span>
                    <a data-bind="click: function(){ $root.selectEntity($data.elementType) }, text: '[' + $data.elementType.fullName + ']'"></a>
                    <span data-bind="text: '(' + ($data.tableName || $data.name) + ')'"></span>
                    <div class="controls">
                        <button class="btn remove" data-bind="click: $root.editEntity($data)">Remove</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
